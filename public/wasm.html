<html>
  <body>
    <p>视频转换mp4</p>
    <input type="file" id="file">
  </body>
  <!-- <script src="ffmpeg.js"></script> -->
  <!-- <script src="ffmpeg.wasm" ></script> -->

  <script>
    var worker = new Worker('worker.js')
    var fileToRead = document.getElementById("file");

    fileToRead.addEventListener("change", function(event) {
      var files = fileToRead.files;
      var len = files.length;
      worker.postMessage(files)
    }, false);

    function getDownloadLink(fileData, fileName) {
      if (fileName.match(/\.jpeg|\.gif|\.jpg|\.png/)) {
        var blob = new Blob([fileData]);
        var src = window.URL.createObjectURL(blob);
        var img = document.createElement('img');

        img.src = src;
        return img;
      }
      else {
        var a = document.createElement('a');
        a.download = fileName;
        var blob = new Blob([fileData]);
        var src = window.URL.createObjectURL(blob);
        a.href = src;
        a.textContent = 'Click here to download ' + fileName + "!";
        return a;
      }
    }
    worker.onmessage = function(e, result){
      debugger
      document.body.appendChild(getDownloadLink(e.data, 'output.mp4'));
    }
  </script>
</html>